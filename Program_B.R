#Programa para MCF Não Paramétrico - Nelson 
library(pracma)
library(reda)
clear()
#Data #Change as needed. Example HPP
c1<-c(6700.14)
c2<-c(6981.70)
c3<-c(708.15, 1087.54, 2632.96, 3795.93, 7650.02, 7936.53, 
      13582.05, 13599.30, 14667.52, 17616.93)
c4<-c(1143.08, 4172.89, 4231.24, 4930.91, 5475.86, 9581.46, 
      10146.97, 12355.46, 14900.22, 16182.83)
c5<-c(2263.72, 7690.81, 9017.68, 9835.47, 10066.96, 11881.84, 
      13731.06, 15937.57, 18639.87, 18707.09)
c6<-c(2000.07, 3285.58, 3575.88, 4071.69, 4882.62, 5174.08, 
      6181.00, 6771.58, 10052.34)
c7<-c(1562.95, 1926.39, 3721.81, 4053.54, 5330.07, 6693.18, 6693.18)
c8<-c(26.12, 6234.08, 9465.25, 9817.33, 10681.84, 12977.78, 14396.38, 14396.38)
c9<-c(8442.23, 8571.35, 8674.22, 10724.29, 11274.46, 11755.99, 11755.99)
c10<-c(708.46, 2334.95, 8018.72, 11369.85, 13432.91, 16321.18, 16321.18)
F=c(c1,c2,c3,c4,c5,c6,c7,c8,c9,c10)
ID=c(1,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,
     6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10)
C=c(0,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,
    1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,1,0,1,1,1,1,1,1,0,1,1,1,1,1,1,0)
M <- mcf(Recur(F, ID, C) ~ 1)
A1=M@MCF$MCF
A2=M@MCF$time
plot(A2,A1,xlab = "Time", ylab = "MCF")
curve((1/2090.3) * x, from = min(A2), to = max(A2), add = TRUE, col = "red",lwd = 1.5)
legend("topleft", legend = "HPP", col = "red", lty =1,cex = 0.5)